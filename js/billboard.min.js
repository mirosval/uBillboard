/*

 uBillboard - Premium Slide for WordPress

 Version: 3.0.0

 Copyright: uDesignStudios (Miroslav Zoricak, Jan Keselak) 2011

*/
(function(c){function A(b){try{console.log(b)}catch(c){}}c.extend(jQuery.easing,{easeInOutQuad:function(b,c,w,k,h){return(c/=h/2)<1?k/2*c*c+w:-k/2*(--c*(c-2)-1)+w}});c.fn.uBillboard=function(b){var f,w,k,h,n,B,x,j,y,i,q,m,u,r={init:function(a,d){f=c(this);w=c(".uds-bb-slides",f);b=c.extend(a,d);f.add(w).css({width:b.width,height:b.height});q={};u=!1;g.initSlides();g.initAnimationMarkup();g.initPreloader();var e=g.preloadImages();g.initControls();c(".uds-bb-slides").live("click",function(){var a=i[m];
if(typeof a.link==="string"&&a.link!==""&&a.link!=="#")window.location=a.link});f.bind("udsBillboardLoadingDidComplete",function(){m=0;var a=i[m],d=g.getSlideBackgroundCSS(a);k.css(d).html(a.html).fadeTo(300,1);g.handleEmbeddedContent(a);x.delay(300).fadeTo(300,1);a=b.pauseOnVideo&&a.transition=="none";b.autoplay===!0&&!a?(g.animateCountdown(i[m].delay),r.play()):typeof j!=="undefined"&&j!==null&&j.hide()});e===!1&&f.trigger("udsBillboardLoadingDidComplete");f.bind("udsBillboardTransitionDidComplete",
function(){})},animateSlide:function(a){if(a!==m)if(i[a]===null)c.error("Slide ID "+a+" does not exist");else{f.trigger("udsBillboardSlideWillChange",m);var d=i[a];g.prepareForAnimation(a);(d.transition=="none"||d.bg=="")&&k.css({backgroundColor:d.bgColor,backgroundImage:"none"});g.handleEmbeddedContent(d);var e="fade";if(d.transition!==null&&typeof d.transition==="string")e=d.transition;if(o[e]===null||typeof o[e]!=="object")c.error('Transition "'+e+'" is not defined');else{o[e].direction=d.direction;
h.show().css("opacity",1);o[e].setup!==null&&typeof o[e].setup==="function"&&o[e].setup();o[e].perform!==null&&typeof o[e].perform==="function"&&o[e].perform();d=1E3;if(o[e].duration!==null&&typeof o[e].duration==="number")d=o[e].duration;clearTimeout(q.transitionComplete);q.transitionComplete=setTimeout(function(){f.trigger("udsBillboardTransitionDidComplete",a)},d);m=a;f.trigger("udsBillboardSlideDidChange",m);b.pauseOnVideo&&i[m].transition=="none"||(u&&g.animateCountdown(i[m].delay),(b.autoplay||
u)&&r.play())}}},next:function(){var a=g.getNextSlideId();r.animateSlide(a)},prev:function(){var a=g.getPrevSlideId();r.animateSlide(a)},random:function(){r.animateSlide(Math.floor(Math.random()*i.length+1))},play:function(){if(typeof m!=="number"||m===null)m=0;q!==null&&q.nextSlideAnimation!==null&&clearTimeout(q.nextSlideAnimation);typeof j!=="undefined"&&j!==null&&j.show();u||g.animateCountdown(i[m].delay);clearTimeout(q.nextSlideAnimation);q.nextSlideAnimation=setTimeout(function(){r.next()},
i[m].delay);u=!0;f.trigger("didChangePlayingState",{playing:u})},pause:function(){u=!1;f.trigger("didChangePlayingState",{playing:u});q.nextSlideAnimation!==null&&clearTimeout(q.nextSlideAnimation);typeof j!=="undefined"&&j.hide()},playpause:function(){u?r.pause():r.play()}},g={initSlides:function(){i=[];c(".uds-bb-slide",f).each(function(a,d){var b={delay:parseInt(c(".uds-delay",d).remove().text(),10),transition:c(".uds-transition",d).remove().text(),direction:c(".uds-direction",d).remove().text(),
bgColor:c(".uds-background",d).remove().text(),bg:c(".uds-bb-bg-image",d).remove().attr("src"),link:c(".uds-bb-link",d).remove().attr("href"),html:c(d).remove().html()};i.push(b)})},initPreloader:function(){f.append('<div class="uds-bb-preloader-wrapper"><div class="uds-bb-preloader"><div class="uds-bb-preloader-indicator"></div></div></div>');y=c(".uds-bb-preloader-wrapper",f);var a=c(".uds-bb-preloader-indicator",y);c(".uds-bb-preloader").css({top:parseInt(b.height,10)/2-a.height()/2+"px",left:parseInt(b.width,
10)/2-a.width()/2+"px"})},updatePreloader:function(a){var b=c(".uds-bb-preloader-indicator",y);b.stop().animate({left:"-"+Math.round((1-a)*b.width())+"px"},200);a>=1&&b.fadeOut("200",function(){y.remove()})},preloadImages:function(){for(var a=0,d=i.length,e=!1,l=0;l<d;l++)i[l].bg!==""&&(e=!0);if(!e)return g.updatePreloader(1),f.trigger("udsBillboardLoadingDidComplete"),!1;for(l=0;l<d;l++)i[l].bg===""?++a:c("<img>").data("slideID",l).load(function(){++a;g.updatePreloader(a/d);a==d&&f.trigger("udsBillboardLoadingDidComplete")}).error(function(){var e=
c(this).data("slideID");A("Failed to load image: "+i[e].bg);++a;g.updatePreloader(a/d);a==d&&f.trigger("udsBillboardLoadingDidComplete");b.removeSlidesWithBrokenImages===!0&&i.splice(e,1)}).attr("src",i[l].bg);return!0},initAnimationMarkup:function(){c(".uds-bb-slides",f).append("<div class='uds-stage'>").append("<div class='uds-next'>");k=c(".uds-stage",f);h=c(".uds-next",f);h.hide();c(k).add(h).css({width:b.width,height:b.height,opacity:0});for(var a=parseInt(b.width,10),d=parseInt(b.height,10),
e=parseInt(b.squareSize,10),a=Math.ceil(a/e),d=Math.ceil(d/e),e=0;e<d;e++)for(var l=0;l<a;l++)c("<div>",{"class":"uds-square uds-column-"+l+" uds-row-"+e+" uds-square-"+(l+a*e)}).data("position",{x:l,y:e}).append(c("<div>",{"class":"uds-square-inside"})).appendTo(h);g.resetAnimation();n=c(".uds-square",f);B=c(".uds-square-inside",f);x=c(".uds-bb-controls",f);g.createCountdown()},resetAnimation:function(){for(var a=parseInt(b.width,10),d=parseInt(b.height,10),e=parseInt(b.squareSize,10),l=Math.ceil(a/
e),g=Math.ceil(d/e),i=0;i<g;i++)for(var p=0;p<l;p++)c(".uds-square-"+(p+l*i),f).css({width:e,height:e,top:i*e,left:p*e,opacity:1}).stop(!0,!0).find(".uds-square-inside").css({width:a,height:d,top:-(i*e),left:-(p*e),opacity:1}).stop(!0,!0);k.add(h).css({top:"0px",left:"0px"})},prepareForAnimation:function(a){var b=i[m],c=i[a];typeof b==="undefined"||b===null?A("Slide "+m+" does not exist! (Current Slide)"):typeof c==="undefined"||c===null?A("Slide "+a+" does not exist! (Next Slide)"):(a=g.getSlideBackgroundCSS(b),
k.css(a).html(b.html),g.resetAnimation(),c.transition!=="none"&&(a=g.getSlideBackgroundCSS(c),B.css(a).html(c.html)))},initControls:function(){x=c(".uds-bb-controls",f);x.css({width:b.width,height:b.height,opacity:0});var a=c(".uds-bb-playpause",f),d=c(".uds-bb-next",f),e=c(".uds-bb-prev",f),l=c(".uds-bb-paginator",f),g=c(".uds-bb-position-indicator-bullets",f),s=c(".uds-bb-thumbnails",f),p=c(".uds-bb-thumb",s);a.click(r.playpause);d.click(r.next);e.click(r.prev);a.addClass("play");f.bind("didChangePlayingState",
function(b,c){a.removeClass("play pause");c.playing?a.addClass("pause"):a.addClass("play")});c(".uds-bb-position-indicator",f).text("1/"+i.length);var h="";for(slide in i)h+="<div class='uds-bb-bullet'></div>";g.append(h).find("div:first").addClass("active");c("div",g).click(function(){r.animateSlide(c(this).index())});f.bind("udsBillboardSlideDidChange",function(){c(".uds-bb-position-indicator").text(m+1+"/"+i.length);c("div",g).removeClass("active").eq(m).addClass("active");p.removeClass("active").eq(m).addClass("active")});
p.removeClass("active").eq(0).addClass("active");p.click(function(){r.animateSlide(c(this).index())});f.has(".uds-bb-thumbnails.top:not(.inside)").css("margin-top",s.outerHeight());f.has(".uds-bb-thumbnails.bottom:not(.inside)").css("margin-bottom",s.outerHeight());f.has(".uds-bb-thumbnails.left:not(.inside)").css("margin-left",s.outerWidth());f.has(".uds-bb-thumbnails.right:not(.inside)").css("margin-right",s.outerWidth());p.each(function(a){var b=c("img",this);b.css({width:b.attr("width")+"px",
height:b.attr("height")+"px"});i[a].bg===""&&i[a].transition!=="none"&&(b.replaceWith("<div>"),c("div",this).css({width:b.attr("width")+"px",height:b.attr("height")+"px",backgroundColor:i[a].bgColor}))}).css("background-color",b.thumbnailHoverColor);var v,j,k,n=0,o=c(".uds-bb-thumbnail-container",s),u=s.is(".right,.left")?"vertical":"horizontal";u=="vertical"?(v=s.height(),h=(p.outerHeight(!0)-p.outerHeight())/2,j=p.length*p.outerHeight(!0)-(p.length-1)*h,k="top",o.css("height",j+"px")):(v=s.width(),
j=p.length*p.outerWidth(!0),k="left",o.css("width",j+"px"));v>j&&(n=v/2-j/2,o.css(k,n+"px"));s.bind({"mouseenter mousemove":function(a){clearInterval(q.thumbMove);q.thumbMove=setInterval(function(){var b=0,b=0,b=u=="vertical"?a.pageY-s.offset().top:a.pageX-s.offset().left;b-=v/2;b/=v/2;v>j||(b<0&&n>0?n--:b>0&&n<j-v&&n++,o.css(k,-n+"px"))},10)},mouseleave:function(){clearInterval(q.thumbMove)}});var t=c("");b.showControls==="hover"&&(t=t.add(d).add(e));b.showPause==="hover"&&(t=t.add(a));b.showPaginator===
"hover"&&(t=t.add(g).add(c(".uds-bb-position-indicator",f)));b.showThumbnails==="hover"&&(t=t.add(s));b.showPaginator!==!0&&b.showPause!==!0&&b.showControls!==!0&&(t=t.add(l));t.fadeTo(0,0);f.hover(function(){t.stop().fadeTo(300,1)},function(){t.stop().fadeTo(300,0)});b.showControls===!1&&(d.hide(),e.hide());b.showPause===!1&&a.hide();b.showPaginator===!1&&(g.hide(),c(".uds-bb-position-indicator",f).hide());b.showThumbnails===!1&&s.hide();c(".uds-center",f).each(function(){var a=c(this).outerWidth()/
2,d=c(this).outerHeight()/2;c(this).css({top:parseInt(b.height,10)/2-d,left:parseInt(b.width,10)/2-a})});c(".uds-center-vertical",f).each(function(){var a=c(this).outerHeight()/2;c(this).css({top:parseInt(b.height,10)/2-a})});c(".uds-center-horizontal",f).each(function(){var a=c(this).outerWidth()/2;c(this).css({left:parseInt(b.width,10)/2-a})})},getNextSlideId:function(){var a=m+1;return typeof i[a]==="undefined"?0:a},getPrevSlideId:function(){var a=m-1;return typeof i[a]==="undefined"?i.length-
1:a},createCountdown:function(){if(b.showTimer!==!1)j=c('<div class="uds-bb-countdown"></div>').appendTo(x),canvas=j.append('<canvas width="100" height="100">').find("canvas").get(0),canvas.getContext?(ctx=canvas.getContext("2d"),ctx.lineWidth=3,ctx.strokeStyle="white",ctx.shadowOffsetX=0,ctx.shadowOffsetY=0,ctx.shadowBlur=2,ctx.shadowColor="black",j.data("context",ctx)):(j.remove(),j=null)},animateCountdown:function(a){if(!(j===null||typeof j==="undefined"||b.showTimer===!1)){var c=j.data("context"),
e=0;if(a!==!1){var l=(new Date).getTime();j.data("start",l);j.data("duration",a);clearInterval(q.countDown);q.countDown=setInterval(function(){g.animateCountdown(!1)},30)}else e=(new Date).getTime()-j.data("start"),a=j.data("duration");e/a>=1&&clearInterval(q.countDown);c.clearRect(0,0,100,100);c.beginPath();c.arc(50,50,20,-Math.PI/2,-Math.PI/2+2*Math.PI*(e/a),!1);c.stroke()}},getSlideBackgroundCSS:function(a){return a.bg!==""?{backgroundColor:"transparent",backgroundImage:"url("+a.bg+")"}:{backgroundColor:a.bgColor,
backgroundImage:""}},handleEmbeddedContent:function(a){a.transition=="none"&&(k.html(a.html),$element=c(">*",k),$element.css({position:"absolute",top:parseInt(b.height,10)/2-$element.attr("height")/2,left:parseInt(b.width,10)/2-$element.attr("width")/2}),c("param[name=wmode][value=opaque]",$element).length===0&&($element.prepend('<param name="wmode" value="opaque" />'),c("embed",$element).attr("wmode","opaque").css({position:"absolute",zIndex:1})))},pos:function(a){return Math.abs(parseInt(a,10))+
"px"},neg:function(a){return"-"+Math.abs(parseInt(a,10))+"px"}},z={none:{delay:c.noop},left:{delay:function(){for(var a=Math.ceil(parseInt(b.width,10)/parseInt(b.squareSize,10)),d=0;d<a;d++)c(".uds-column-"+d,f).delay(d*(600/a))}},right:{delay:function(){for(var a=Math.ceil(parseInt(b.width,10)/parseInt(b.squareSize,10)),d=0;d<a;d++)c(".uds-column-"+d,f).delay(600-d*(600/a))}},top:{delay:function(){for(var a=Math.ceil(parseInt(b.height,10)/parseInt(b.squareSize,10)),d=0;d<a;d++)c(".uds-row-"+d,f).delay(d*
(600/a))}},bottom:{delay:function(){for(var a=Math.ceil(parseInt(b.height,10)/parseInt(b.squareSize,10)),d=0;d<a;d++)c(".uds-row-"+d,f).delay(600-d*(600/a))}},center:{delay:function(){for(var a=Math.ceil(parseInt(b.height,10)/parseInt(b.squareSize,10)),d=Math.ceil(parseInt(b.width,10)/parseInt(b.squareSize,10)),e=0;e<d;e++)for(var l=0;l<a;l++){var f=Math.sqrt(Math.pow(e-d/2+0.5,2)+Math.pow(l-a/2+0.5,2))/Math.sqrt(Math.pow(d/2,2)+Math.pow(a/2,2));c(".uds-square-"+(l*d+e)).delay(700*f)}}},randomSquares:{delay:function(){n.each(function(){c(this).delay(Math.random()*
700)})}},spiralIn:{delay:function(){for(var a=Math.ceil(parseInt(b.width,10)/parseInt(b.squareSize,10)),d=Math.ceil(parseInt(b.height,10)/parseInt(b.squareSize,10)),e=0,l=a-1,f=0,g=d-1,i=0,j=0,h=0;i<a*d;)c(".uds-square-"+(a*h+j)).delay(1E3*(i/(a*d))),h==f&&j<l?j++:j==l&&h<g?h++:h==g&&j>e?j--:(h--,h==f&&(j++,h++,e++,l--,f++,g--)),i++}},spiralOut:{delay:function(){for(var a=Math.ceil(parseInt(b.width,10)/parseInt(b.squareSize,10)),d=Math.ceil(parseInt(b.height,10)/parseInt(b.squareSize,10)),e=0,f=a-
1,g=0,i=d-1,j=0,h=0,k=0;j<a*d;)c(".uds-square-"+(a*k+h)).delay(1E3-1E3*(j/(a*d))),k==g&&h<f?h++:h==f&&k<i?k++:k==i&&h>e?h--:(k--,k==g&&(h++,k++,e++,f--,g++,i--)),j++}},chess:{delay:function(){for(var a=Math.ceil(parseInt(b.height,10)/parseInt(b.squareSize,10)),d=Math.ceil(parseInt(b.width,10)/parseInt(b.squareSize,10)),e=0;e<d;e++)for(var f=0;f<a;f++){var g=f%2==0&&e%2==0||f%2==1&&e%2==1?0:1;c(".uds-square-"+(f*d+e)).delay(200*g)}}},zigzagHorizontal:{delay:function(){for(var a=Math.ceil(parseInt(b.height,
10)/parseInt(b.squareSize,10)),d=Math.ceil(parseInt(b.width,10)/parseInt(b.squareSize,10)),e=0;e<d;e++)for(var f=0;f<a;f++){var g=(f*a+(f%2==0?e:d-e))/(a*a+d/2);c(".uds-square-"+(f*d+e)).delay(700*g)}}},zigzagVertical:{delay:function(){for(var a=Math.ceil(parseInt(b.height,10)/parseInt(b.squareSize,10)),d=Math.ceil(parseInt(b.width,10)/parseInt(b.squareSize,10)),e=0;e<d;e++)for(var f=0;f<a;f++){var g=(e*d+(e%2==0?f:a-f))/(d*d+a/2);c(".uds-square-"+(f*d+e)).delay(700*g)}}}},o={none:{duration:0,direction:"",
setup:function(){h.hide()},perform:c.noop()},fade:{duration:1E3,direction:"",setup:function(){n.css({opacity:0})},perform:function(){z[this.direction].delay();n.animate({opacity:1},{duration:500})}},slide:{duration:700,direction:"right",setup:function(){c(".uds-bb-slides",f).css({overflow:"hidden"});k.css({top:"0px",left:"0px"});if(this.direction==="left")h.show().css({top:"0px",left:g.neg(b.width)});else if(this.direction==="top")h.show().css({top:g.neg(b.height),left:"0px"});else if(this.direction===
"bottom")h.show().css({top:g.pos(b.height),left:"0px"});else if(this.direction==="top")h.show().css({top:"0px",left:g.pos(b.width)});else if(this.direction==="zigzagHorizontal"){parseInt(b.squareSize,10);var a=parseInt(b.height,10);n.each(function(){c(this).css({opacity:0,top:parseInt(c(this).css("top"),10)-a+"px"})});z[this.direction].delay()}else if(this.direction==="zigzagVertical"){parseInt(b.squareSize,10);var d=parseInt(b.width,10);n.each(function(){c(this).css({opacity:0,left:parseInt(c(this).css("left"),
10)-d+"px"})});z[this.direction].delay()}else h.show().css({top:"0px",left:g.pos(b.width)})},perform:function(){var a={duration:700,easing:"easeInOutQuad"};if(this.direction==="left")k.animate({left:g.pos(b.width)},a),h.animate({left:"0px"},a);else if(this.direction==="top")k.animate({top:g.pos(b.height)},a),h.animate({top:"0px"},a);else if(this.direction==="bottom")k.animate({top:g.neg(b.height)},a),h.animate({top:"0px"},a);else if(this.direction==="top")k.animate({left:g.neg(b.width)},a),h.animate({left:"0px"},
a);else if(this.direction==="zigzagHorizontal"){parseInt(b.squareSize,10);var d=parseInt(b.height,10);n.each(function(){c(this).animate({opacity:1,top:parseInt(c(this).css("top"),10)+d+"px"},a)})}else if(this.direction==="zigzagVertical"){parseInt(b.squareSize,10);var e=parseInt(b.width,10);n.each(function(){c(this).animate({opacity:1,left:parseInt(c(this).css("left"),10)+e+"px"},a)})}else k.animate({left:g.neg(b.width)},a),h.animate({left:"0px"},a)}},scale:{duration:1100,direction:"",setup:function(){var a,
d;if(this.direction==="right")a=g.pos(parseInt(b.height,10)/2),d=g.pos(b.width);else if(this.direction==="left")a=g.pos(parseInt(b.height,10)/2),d="0px";else if(this.direction==="top")a="0px",d=g.pos(parseInt(b.width,10)/2);else if(this.direction==="bottom")a=g.pos(b.height),d=g.pos(parseInt(b.width,10)/2);else if(this.direction==="center")a=g.pos(parseInt(b.height,10)/2),d=g.pos(parseInt(b.width,10)/2);else{if(this.direction==="zigzagHorizontal"){var e=parseInt(b.squareSize,10);n.each(function(){c(this).css({top:parseInt(c(this).css("top"),
10)+e/2+"px",left:parseInt(c(this).css("left"),10)+e/2+"px",height:"0px"})})}else this.direction==="zigzagVertical"?(e=parseInt(b.squareSize,10),n.each(function(){c(this).css({top:parseInt(c(this).css("top"),10)+e/2+"px",left:parseInt(c(this).css("left"),10)+e/2+"px",width:"0px"})})):(e=parseInt(b.squareSize,10),n.each(function(){c(this).css({top:parseInt(c(this).css("top"),10)+e/2+"px",left:parseInt(c(this).css("left"),10)+e/2+"px",width:"0px",height:"0px"})}));z[this.direction].delay();return}h.css({top:a,
left:d,width:"1px",height:"1px"})},perform:function(){if(c.inArray(this.direction,["center","top","left","bottom","right"])>-1)h.animate({top:"0px",left:"0px",width:b.width,height:b.height},{duration:1E3,easing:"easeInOutQuad"});else{var a=parseInt(b.squareSize,10);n.each(function(b,e){c(this).animate({top:parseInt(c(e).css("top"),10)-a/2+"px",left:parseInt(c(e).css("left"),10)-a/2+"px",width:a+"px",height:a+"px"},500)})}}}},C={width:"960px",height:"400px",squareSize:"80px",autoplay:!0,showControls:!0,
showPause:!0,showPaginator:!0,showThumbnails:!0,showTimer:!0,removeSlidesWithBrokenImages:!0};return this.each(function(){c(this);if(r[b])return r[b].apply(this,Array.prototype.slice.call(arguments,1));else if(typeof b==="object"||!b)return r.init.apply(this,[C,b]);else c.error("Method "+b+" does not exist on uBillboard")})}})(jQuery);